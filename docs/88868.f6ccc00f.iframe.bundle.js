"use strict";(self.webpackChunk_storiny_monorepo=self.webpackChunk_storiny_monorepo||[]).push([[88868],{"./packages/editor/src/plugins/caption/index.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>caption_caption});var LexicalComposerContext_prod=__webpack_require__("./node_modules/@lexical/react/LexicalComposerContext.prod.mjs"),LexicalUtils_prod=__webpack_require__("./node_modules/@lexical/utils/LexicalUtils.prod.mjs"),Lexical_prod=__webpack_require__("./node_modules/lexical/Lexical.prod.mjs"),react=__webpack_require__("./node_modules/next/dist/compiled/react/index.js"),block=__webpack_require__("./packages/editor/src/nodes/block/block.ts"),caption=__webpack_require__("./packages/editor/src/nodes/caption/caption.ts"),figure=__webpack_require__("./packages/editor/src/nodes/figure/figure.ts");const caption_caption=()=>{const[editor]=(0,LexicalComposerContext_prod.DF)();return react.useEffect((()=>(0,LexicalUtils_prod.Sd)(editor.registerMutationListener(caption.NG,(mutated_nodes=>{for(const[node_key,mutation]of mutated_nodes)"updated"===mutation&&editor.getEditorState().read((()=>{const caption_node=(0,Lexical_prod.ns)(node_key),caption_element=editor.getElementByKey(node_key);null!==caption_node&&null!==caption_element&&caption_element.setAttribute("data-empty",String(caption_node.isEmpty()))}))})),editor.registerMutationListener(figure.T5,((mutated_nodes,{updateTags:update_tags})=>{if(!update_tags.has("collaboration"))for(const[node_key,mutation]of mutated_nodes)"updated"===mutation&&editor.update((()=>{const figure_node=(0,Lexical_prod.ns)(node_key);if(null!==figure_node){const $is_first_child=node=>0===node.getIndexWithinParent();for(const node of figure_node.getChildren())((0,block.K)(node)&&!$is_first_child(node)||!(0,block.K)(node)&&!(0,caption.tN)(node))&&figure_node.insertAfter(node);(0,caption.tN)(figure_node.getLastChild())||figure_node.append((0,caption.jS)())}}))})))),[editor]),null}}}]);