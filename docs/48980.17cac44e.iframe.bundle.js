"use strict";(self.webpackChunk_storiny_monorepo=self.webpackChunk_storiny_monorepo||[]).push([[48980],{"./packages/ui/src/components/zoom/zoom.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>zoom});var jsx_runtime=__webpack_require__("./node_modules/next/dist/compiled/react/jsx-runtime.js"),clsx_m=__webpack_require__("./node_modules/clsx/dist/clsx.m.js"),index_browser=__webpack_require__("./node_modules/nanoid/index.browser.js"),react=__webpack_require__("./node_modules/next/dist/compiled/react/index.js"),react_dom=__webpack_require__("./node_modules/next/dist/compiled/react-dom/index.js"),icon_button=__webpack_require__("./packages/ui/src/components/icon-button/icon-button.tsx"),create_svg_icon=__webpack_require__("./packages/ui/src/utils/create-svg-icon/create-svg-icon.tsx");const MaximizeIcon=(0,jsx_runtime.jsx)("path",{d:"M2 4V3a1 1 0 0 1 1-1h1M2 8v1a1 1 0 0 0 1 1h1m4-8h1a1 1 0 0 1 1 1v1m-2 6h1a1 1 0 0 0 1-1V8"}),maximize=(0,create_svg_icon.S)(MaximizeIcon,"maximize"),MinimizeIcon=(0,jsx_runtime.jsx)("path",{d:"M7.5 9.5v-1a1 1 0 0 1 1-1h1m-2-5v1a1 1 0 0 0 1 1h1m-7 3h1a1 1 0 0 1 1 1v1m-2-5h1a1 1 0 0 0 1-1v-1"}),minimize=(0,create_svg_icon.S)(MinimizeIcon,"minimize"),test_element_type=(type,element)=>{var _element_tagName_toUpperCase,_element_tagName;return type===(null==element||null===(_element_tagName=element.tagName)||void 0===_element_tagName||null===(_element_tagName_toUpperCase=_element_tagName.toUpperCase)||void 0===_element_tagName_toUpperCase?void 0:_element_tagName_toUpperCase.call(_element_tagName))},test_div=element=>test_element_type("DIV",element)||test_element_type("SPAN",element),test_img=element=>test_element_type("IMG",element),URL_REGEX=/url(?:\(['"]?)(.*?)(?:['"]?\))/,get_img_src=img_element=>{if(img_element){if(test_img(img_element))return img_element.currentSrc;if(test_div(img_element)){const bg_img=window.getComputedStyle(img_element).backgroundImage;var _URL_REGEX_exec;if(bg_img)return null===(_URL_REGEX_exec=URL_REGEX.exec(bg_img))||void 0===_URL_REGEX_exec?void 0:_URL_REGEX_exec[1]}}},get_scale_to_window=({height,offset,width})=>Math.min((window.innerWidth-2*offset)/width,(window.innerHeight-2*offset)/height),get_scale=({container_height,container_width,has_scalable_src,offset,target_height,target_width})=>container_height&&container_width?!has_scalable_src&&target_height&&target_width?(({container_height,container_width,offset,target_height,target_width})=>{const scale=get_scale_to_window({offset,height:target_height,width:target_width}),ratio=target_width>target_height?target_width/container_width:target_height/container_height;return scale>1?ratio:scale*ratio})({container_height,container_width,offset,target_height,target_width}):get_scale_to_window({height:container_height,offset,width:container_width}):1,parse_position=({position,relative_num})=>{const position_val=parseFloat(position);return position.endsWith("%")?relative_num*position_val/100:position_val},SRC_SVG_REGEX=/\.svg$/i,get_modal_img_style=({has_zoom_img,img_src,is_zoomed,loaded_img_element,offset,should_refresh,target_element})=>{var _img_src_slice;const has_scalable_src="data:image/svg+xml"===(null==img_src||null===(_img_src_slice=img_src.slice)||void 0===_img_src_slice?void 0:_img_src_slice.call(img_src,0,18))||has_zoom_img||!(!img_src||!SRC_SVG_REGEX.test(img_src)),img_rect=target_element.getBoundingClientRect(),target_element_computed_style=window.getComputedStyle(target_element),is_div_img=null!=loaded_img_element&&test_div(target_element),is_img_object_fit=null!=loaded_img_element&&!is_div_img,img_regular_style=(({container_height,container_left,container_top,container_width,has_scalable_src,offset,target_height,target_width})=>{const scale=get_scale({container_height,container_width,has_scalable_src,offset,target_height,target_width});return{top:container_top,left:container_left,width:container_width*scale,height:container_height*scale,transform:`translate(0,0) scale(${1/scale})`}})({container_height:img_rect.height,container_left:img_rect.left,container_top:img_rect.top,container_width:img_rect.width,has_scalable_src,offset,target_height:(null==loaded_img_element?void 0:loaded_img_element.naturalHeight)||img_rect.height,target_width:(null==loaded_img_element?void 0:loaded_img_element.naturalWidth)||img_rect.width}),img_object_fit_style=is_img_object_fit?(({container_height,container_left,container_top,container_width,has_scalable_src,object_fit,object_position,offset,target_height,target_width})=>{if("scale-down"===object_fit&&(object_fit=target_width<=container_width&&target_height<=container_height?"none":"contain"),"cover"===object_fit||"contain"===object_fit){const width_ratio=container_width/target_width,height_ratio=container_height/target_height,ratio="cover"===object_fit?Math.max(width_ratio,height_ratio):Math.min(width_ratio,height_ratio),[pos_left="50%",pos_top="50%"]=object_position.split(" "),pos_x=parse_position({position:pos_left,relative_num:container_width-target_width*ratio}),pos_y=parse_position({position:pos_top,relative_num:container_height-target_height*ratio}),scale=get_scale({container_height:target_height*ratio,container_width:target_width*ratio,has_scalable_src,offset,target_height,target_width});return{top:container_top+pos_y,left:container_left+pos_x,width:target_width*ratio*scale,height:target_height*ratio*scale,transform:`translate(0,0) scale(${1/scale})`}}if("none"===object_fit){const[pos_left="50%",pos_top="50%"]=object_position.split(" "),pos_x=parse_position({position:pos_left,relative_num:container_width-target_width}),pos_y=parse_position({position:pos_top,relative_num:container_height-target_height}),scale=get_scale({container_height:target_height,container_width:target_width,has_scalable_src,offset,target_height,target_width});return{top:container_top+pos_y,left:container_left+pos_x,width:target_width*scale,height:target_height*scale,transform:`translate(0,0) scale(${1/scale})`}}if("fill"===object_fit){const width_ratio=container_width/target_width,height_ratio=container_height/target_height,ratio=Math.max(width_ratio,height_ratio),scale=get_scale({container_height:target_height*ratio,container_width:target_width*ratio,has_scalable_src,offset,target_height,target_width});return{width:container_width*scale,height:container_height*scale,transform:`translate(0,0) scale(${1/scale})`}}return{}})({container_height:img_rect.height,container_left:img_rect.left,container_top:img_rect.top,container_width:img_rect.width,has_scalable_src,object_fit:target_element_computed_style.objectFit,object_position:target_element_computed_style.objectPosition,offset,target_height:(null==loaded_img_element?void 0:loaded_img_element.naturalHeight)||img_rect.height,target_width:(null==loaded_img_element?void 0:loaded_img_element.naturalWidth)||img_rect.width}):void 0,div_img_style=is_div_img?(({background_position,background_size,container_height,container_left,container_top,container_width,has_scalable_src,offset,target_height,target_width})=>{if("cover"===background_size||"contain"===background_size){const width_ratio=container_width/target_width,height_ratio=container_height/target_height,ratio="cover"===background_size?Math.max(width_ratio,height_ratio):Math.min(width_ratio,height_ratio),[pos_left="50%",pos_top="50%"]=background_position.split(" "),pos_x=parse_position({position:pos_left,relative_num:container_width-target_width*ratio}),pos_y=parse_position({position:pos_top,relative_num:container_height-target_height*ratio}),scale=get_scale({container_height:target_height*ratio,container_width:target_width*ratio,has_scalable_src,offset,target_height,target_width});return{top:container_top+pos_y,left:container_left+pos_x,width:target_width*ratio*scale,height:target_height*ratio*scale,transform:`translate(0,0) scale(${1/scale})`}}if("auto"===background_size){const[pos_left="50%",pos_top="50%"]=background_position.split(" "),pos_x=parse_position({position:pos_left,relative_num:container_width-target_width}),pos_y=parse_position({position:pos_top,relative_num:container_height-target_height}),scale=get_scale({container_height:target_height,container_width:target_width,has_scalable_src,offset,target_height,target_width});return{top:container_top+pos_y,left:container_left+pos_x,width:target_width*scale,height:target_height*scale,transform:`translate(0,0) scale(${1/scale})`}}{const[size_w="50%",size_h="50%"]=background_size.split(" "),width_ratio=parse_position({position:size_w,relative_num:container_width})/target_width,height_ratio=parse_position({position:size_h,relative_num:container_height})/target_height,ratio=Math.min(width_ratio,height_ratio),[pos_left="50%",pos_top="50%"]=background_position.split(" "),pos_x=parse_position({position:pos_left,relative_num:container_width-target_width*ratio}),pos_y=parse_position({position:pos_top,relative_num:container_height-target_height*ratio}),scale=get_scale({container_height:target_height*ratio,container_width:target_width*ratio,has_scalable_src,offset,target_height,target_width});return{top:container_top+pos_y,left:container_left+pos_x,width:target_width*ratio*scale,height:target_height*ratio*scale,transform:`translate(0,0) scale(${1/scale})`}}})({background_position:target_element_computed_style.backgroundPosition,background_size:target_element_computed_style.backgroundSize,container_height:img_rect.height,container_left:img_rect.left,container_top:img_rect.top,container_width:img_rect.width,has_scalable_src,offset,target_height:(null==loaded_img_element?void 0:loaded_img_element.naturalHeight)||img_rect.height,target_width:(null==loaded_img_element?void 0:loaded_img_element.naturalWidth)||img_rect.width}):void 0,style=Object.assign({},img_regular_style,img_object_fit_style,div_img_style);if(is_zoomed){const viewport_x=window.innerWidth/2,viewport_y=window.innerHeight/2,translate_x=viewport_x-(parseFloat(String(style.left||0))+parseFloat(String(style.width||0))/2),translate_y=viewport_y-(parseFloat(String(style.top||0))+parseFloat(String(style.height||0))/2);should_refresh&&(style.transitionDuration="0.01ms"),style.transform=`translate(${translate_x}px,${translate_y}px) scale(1)`}return style.height="number"==typeof style.height?Math.round(style.height):style.height,style.width="number"==typeof style.width?Math.round(style.width):style.width,style},get_ghost_style=img_element=>img_element?{height:img_element.offsetHeight,left:img_element.offsetLeft,width:img_element.offsetWidth,top:img_element.offsetTop}:{},test_img_loaded=element=>element.complete&&0!==element.naturalHeight;var injectStylesIntoStyleTag=__webpack_require__("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),injectStylesIntoStyleTag_default=__webpack_require__.n(injectStylesIntoStyleTag),styleDomAPI=__webpack_require__("./node_modules/style-loader/dist/runtime/styleDomAPI.js"),styleDomAPI_default=__webpack_require__.n(styleDomAPI),insertBySelector=__webpack_require__("./node_modules/style-loader/dist/runtime/insertBySelector.js"),insertBySelector_default=__webpack_require__.n(insertBySelector),setAttributesWithoutAttributes=__webpack_require__("./node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js"),setAttributesWithoutAttributes_default=__webpack_require__.n(setAttributesWithoutAttributes),insertStyleElement=__webpack_require__("./node_modules/style-loader/dist/runtime/insertStyleElement.js"),insertStyleElement_default=__webpack_require__.n(insertStyleElement),styleTagTransform=__webpack_require__("./node_modules/style-loader/dist/runtime/styleTagTransform.js"),styleTagTransform_default=__webpack_require__.n(styleTagTransform),zoom_module=__webpack_require__("./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[14].use[1]!./node_modules/resolve-url-loader/index.js!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[14].use[3]!./packages/ui/src/components/zoom/zoom.module.scss"),options={};options.styleTagTransform=styleTagTransform_default(),options.setAttributes=setAttributesWithoutAttributes_default(),options.insert=insertBySelector_default().bind(null,"head"),options.domAPI=styleDomAPI_default(),options.insertStyleElement=insertStyleElement_default();injectStylesIntoStyleTag_default()(zoom_module.A,options);const zoom_zoom_module=zoom_module.A&&zoom_module.A.locals?zoom_module.A.locals:void 0,IMAGE_QUERY=["img",'[role="img"]',"[data-zoom]"].map((x=>`${x}:not([aria-hidden="true"])`)).join(","),default_body_attrs={overflow:"",width:""};class ZoomBase extends react.Component{set_navbar_visibility(hidden){var _this_navbar_element_setAttribute,_this_navbar_element;null===(_this_navbar_element=this.navbar_element)||void 0===_this_navbar_element||null===(_this_navbar_element_setAttribute=_this_navbar_element.setAttribute)||void 0===_this_navbar_element_setAttribute||_this_navbar_element_setAttribute.call(_this_navbar_element,"data-hidden",String(hidden))}render(){const{handle_unzoom_button_click,handle_dialog_cancel,handle_dialog_click,handle_dialog_close,handle_zoom,img_element,props:{children,dialog_class,is_zoomed,wrap_element:WrapElement,slot_props:{zoom_img}={},zoom_margin},content_ref,dialog_ref,modal_content_ref,modal_img_ref,wrap_ref,state:{id,is_zoom_img_loaded,loaded_img_element,modal_state,should_refresh,ghost_style}}=this,modal_id=`zoom-modal-${id}`,modal_img_id=`zoom-modal-img-${id}`,is_div=test_div(img_element),is_img=test_img(img_element),img_alt=(img_element=>{var _img_element_alt,_img_element_getAttribute;if(img_element)return test_img(img_element)?null!==(_img_element_alt=img_element.alt)&&void 0!==_img_element_alt?_img_element_alt:void 0:null!==(_img_element_getAttribute=img_element.getAttribute("aria-label"))&&void 0!==_img_element_getAttribute?_img_element_getAttribute:void 0})(img_element),img_src=get_img_src(img_element),img_src_set=is_img?img_element.srcset:void 0,img_cross_origin=is_img?img_element.crossOrigin:void 0,has_zoom_img=!!(null==zoom_img?void 0:zoom_img.src),has_image=this.has_image(),zoom_button_label=img_alt?`Expand image: ${img_alt}`:"Expand image",is_modal_active="loading"===modal_state||"loaded"===modal_state,data_content_state=has_image?"ready":"idle",data_overlay_state="unloaded"===modal_state||"unloading"===modal_state?"hidden":"visible",content_style={visibility:"unloaded"===modal_state?"visible":"hidden"};this.modal_img_style=has_image?get_modal_img_style({has_zoom_img,img_src,is_zoomed:is_zoomed&&is_modal_active,loaded_img_element,offset:zoom_margin,should_refresh,target_element:img_element}):{};let modal_content=null;if(has_image){const modal_img=is_img||is_div?(0,jsx_runtime.jsx)("img",{alt:img_alt,crossOrigin:img_cross_origin,src:img_src,srcSet:img_src_set,...is_zoom_img_loaded&&"loaded"===modal_state?zoom_img:{},className:zoom_zoom_module["modal-img"],height:this.modal_img_style.height||void 0,id:modal_img_id,ref:modal_img_ref,style:this.modal_img_style,width:this.modal_img_style.width||void 0}):null,modal_unzoom_button=(0,jsx_runtime.jsx)(icon_button.A,{"aria-label":"Minimize image",className:zoom_zoom_module["unzoom-btn"],onClick:handle_unzoom_button_click,variant:"ghost",children:(0,jsx_runtime.jsx)(minimize,{})});modal_content=(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[modal_img,modal_unzoom_button]})}return(0,jsx_runtime.jsxs)(WrapElement,{"aria-owns":modal_id,className:(0,clsx_m.A)(zoom_zoom_module.zoom,"visible"===data_overlay_state&&zoom_zoom_module.active),ref:wrap_ref,children:[(0,jsx_runtime.jsx)(WrapElement,{className:zoom_zoom_module.content,"data-state":data_content_state,ref:content_ref,style:content_style,children}),has_image&&(0,jsx_runtime.jsx)(WrapElement,{className:zoom_zoom_module.ghost,style:ghost_style,children:(0,jsx_runtime.jsx)(icon_button.A,{"aria-label":zoom_button_label,className:zoom_zoom_module["zoom-btn"],onClick:handle_zoom,variant:"ghost",children:(0,jsx_runtime.jsx)(maximize,{})})}),has_image&&react_dom.createPortal((0,jsx_runtime.jsxs)("dialog",{"aria-labelledby":modal_img_id,"aria-modal":"true",className:(0,clsx_m.A)(zoom_zoom_module.modal,dialog_class),id:modal_id,onCancel:handle_dialog_cancel,onClick:handle_dialog_click,onClose:handle_dialog_close,ref:dialog_ref,role:"dialog",children:[(0,jsx_runtime.jsx)("div",{className:zoom_zoom_module.overlay,"data-state":data_overlay_state}),(0,jsx_runtime.jsx)("div",{className:zoom_zoom_module["modal-content"],ref:modal_content_ref,children:modal_content})]}),this.get_dialog_container())]})}componentDidMount(){this.set_id(),this.set_and_track_img(),this.handle_img_load(),this.navbar_element=document.querySelector("[data-global-header]")}componentWillUnmount(){var _this_content_change_observer_disconnect,_this_content_change_observer,_this_content_not_found_change_observer_disconnect,_this_content_not_found_change_observer,_this_img_element_resize_observer_disconnect,_this_img_element_resize_observer,_this_img_element_removeEventListener,_this_img_element,_this_img_element_removeEventListener1,_this_img_element1,_this_modal_img_ref_current_removeEventListener,_this_modal_img_ref_current;"unloaded"!==this.state.modal_state&&this.body_scroll_enable(),null===(_this_content_change_observer=this.content_change_observer)||void 0===_this_content_change_observer||null===(_this_content_change_observer_disconnect=_this_content_change_observer.disconnect)||void 0===_this_content_change_observer_disconnect||_this_content_change_observer_disconnect.call(_this_content_change_observer),null===(_this_content_not_found_change_observer=this.content_not_found_change_observer)||void 0===_this_content_not_found_change_observer||null===(_this_content_not_found_change_observer_disconnect=_this_content_not_found_change_observer.disconnect)||void 0===_this_content_not_found_change_observer_disconnect||_this_content_not_found_change_observer_disconnect.call(_this_content_not_found_change_observer),null===(_this_img_element_resize_observer=this.img_element_resize_observer)||void 0===_this_img_element_resize_observer||null===(_this_img_element_resize_observer_disconnect=_this_img_element_resize_observer.disconnect)||void 0===_this_img_element_resize_observer_disconnect||_this_img_element_resize_observer_disconnect.call(_this_img_element_resize_observer),null===(_this_img_element=this.img_element)||void 0===_this_img_element||null===(_this_img_element_removeEventListener=_this_img_element.removeEventListener)||void 0===_this_img_element_removeEventListener||_this_img_element_removeEventListener.call(_this_img_element,"load",this.handle_img_load),null===(_this_img_element1=this.img_element)||void 0===_this_img_element1||null===(_this_img_element_removeEventListener1=_this_img_element1.removeEventListener)||void 0===_this_img_element_removeEventListener1||_this_img_element_removeEventListener1.call(_this_img_element1,"click",this.handle_zoom),null===(_this_modal_img_ref_current=this.modal_img_ref.current)||void 0===_this_modal_img_ref_current||null===(_this_modal_img_ref_current_removeEventListener=_this_modal_img_ref_current.removeEventListener)||void 0===_this_modal_img_ref_current_removeEventListener||_this_modal_img_ref_current_removeEventListener.call(_this_modal_img_ref_current,"transitionend",this.handle_img_transition_end),window.removeEventListener("wheel",this.handle_wheel),window.removeEventListener("touchstart",this.handle_touch_start),window.removeEventListener("touchmove",this.handle_touch_move),window.removeEventListener("touchend",this.handle_touch_end),window.removeEventListener("touchcancel",this.handle_touch_cancel),window.removeEventListener("resize",this.handle_resize),document.removeEventListener("keydown",this.handle_key_down,!0),this.set_navbar_visibility(!1)}componentDidUpdate(prev_props,prev_state){this.handle_modal_state_change(prev_state.modal_state),this.handle_zoom_changed(prev_props.is_zoomed)}constructor(...args){super(...args),this.state={id:"",is_zoom_img_loaded:!1,loaded_img_element:void 0,modal_state:"unloaded",should_refresh:!1,ghost_style:{},navbar_element:null},this.content_ref=react.createRef(),this.dialog_ref=react.createRef(),this.modal_content_ref=react.createRef(),this.modal_img_ref=react.createRef(),this.wrap_ref=react.createRef(),this.img_element=null,this.is_scaling=!1,this.prev_body_attrs=default_body_attrs,this.modal_img_style={},this.navbar_element=null,this.handle_modal_state_change=prev_modal_state=>{const{modal_state}=this.state;if("loading"!==prev_modal_state&&"loading"===modal_state)this.load_zoom_img(),window.addEventListener("resize",this.handle_resize,{passive:!0}),window.addEventListener("touchstart",this.handle_touch_start,{passive:!0}),window.addEventListener("touchmove",this.handle_touch_move,{passive:!0}),window.addEventListener("touchend",this.handle_touch_end,{passive:!0}),window.addEventListener("touchcancel",this.handle_touch_cancel,{passive:!0}),document.addEventListener("keydown",this.handle_key_down,!0);else if("loaded"!==prev_modal_state&&"loaded"===modal_state)window.addEventListener("wheel",this.handle_wheel,{passive:!0});else if("unloading"!==prev_modal_state&&"unloading"===modal_state)this.ensure_img_transition_end(),window.removeEventListener("wheel",this.handle_wheel),window.removeEventListener("touchstart",this.handle_touch_start),window.removeEventListener("touchmove",this.handle_touch_move),window.removeEventListener("touchend",this.handle_touch_end),window.removeEventListener("touchcancel",this.handle_touch_cancel),document.removeEventListener("keydown",this.handle_key_down,!0);else if("unloaded"!==prev_modal_state&&"unloaded"===modal_state){var _this_modal_img_ref_current_removeEventListener,_this_modal_img_ref_current,_this_dialog_ref_current_close,_this_dialog_ref_current;this.body_scroll_enable(),window.removeEventListener("resize",this.handle_resize),null===(_this_modal_img_ref_current=this.modal_img_ref.current)||void 0===_this_modal_img_ref_current||null===(_this_modal_img_ref_current_removeEventListener=_this_modal_img_ref_current.removeEventListener)||void 0===_this_modal_img_ref_current_removeEventListener||_this_modal_img_ref_current_removeEventListener.call(_this_modal_img_ref_current,"transitionend",this.handle_img_transition_end),null===(_this_dialog_ref_current=this.dialog_ref.current)||void 0===_this_dialog_ref_current||null===(_this_dialog_ref_current_close=_this_dialog_ref_current.close)||void 0===_this_dialog_ref_current_close||_this_dialog_ref_current_close.call(_this_dialog_ref_current)}},this.get_dialog_container=()=>{let element=document.querySelector("[data-zoom-portal]");return null==element&&(element=document.createElement("div"),element.setAttribute("data-zoom-portal",""),document.body.appendChild(element)),element},this.set_id=()=>{this.setState({id:(0,index_browser.Ak)(12)})},this.set_and_track_img=()=>{const content_element=this.content_ref.current;var _this_content_not_found_change_observer_disconnect,_this_content_not_found_change_observer;content_element&&(this.img_element=content_element.querySelector(IMAGE_QUERY),this.img_element?(null===(_this_content_not_found_change_observer=this.content_not_found_change_observer)||void 0===_this_content_not_found_change_observer||null===(_this_content_not_found_change_observer_disconnect=_this_content_not_found_change_observer.disconnect)||void 0===_this_content_not_found_change_observer_disconnect||_this_content_not_found_change_observer_disconnect.call(_this_content_not_found_change_observer),this.img_element.addEventListener("load",this.handle_img_load),this.img_element.addEventListener("click",this.handle_zoom),this.state.loaded_img_element||this.handle_img_load(),this.img_element_resize_observer=new ResizeObserver((entries=>{const entry=entries[0];(null==entry?void 0:entry.target)&&(this.img_element=entry.target,this.setState({ghost_style:get_ghost_style(this.img_element)}))})),this.img_element_resize_observer.observe(this.img_element),this.content_change_observer||(this.content_change_observer=new MutationObserver((()=>{this.setState({ghost_style:get_ghost_style(this.img_element)})})),this.content_change_observer.observe(content_element,{attributes:!0,childList:!0,subtree:!0}))):this.content_not_found_change_observer||(this.content_not_found_change_observer=new MutationObserver(this.set_and_track_img),this.content_not_found_change_observer.observe(content_element,{childList:!0,subtree:!0})))},this.handle_zoom_changed=prev_is_zoomed=>{const{is_zoomed}=this.props;!prev_is_zoomed&&is_zoomed?this.zoom():prev_is_zoomed&&!is_zoomed&&this.unzoom()},this.handle_img_load=()=>{const img_src=get_img_src(this.img_element);if(!img_src)return;const img=new Image;test_img(this.img_element)&&(img.sizes=this.img_element.sizes,img.srcset=this.img_element.srcset,img.crossOrigin=this.img_element.crossOrigin),img.src=img_src;const set_loaded=()=>{this.setState({loaded_img_element:img,ghost_style:get_ghost_style(this.img_element)})};img.decode().then(set_loaded).catch((()=>{test_img_loaded(img)?set_loaded():img.onload=set_loaded}))},this.handle_zoom=()=>{var _this_props_on_zoom_change,_this_props;this.has_image()&&(null===(_this_props_on_zoom_change=(_this_props=this.props).on_zoom_change)||void 0===_this_props_on_zoom_change||_this_props_on_zoom_change.call(_this_props,!0))},this.handle_unzoom=()=>{var _this_props_on_zoom_change,_this_props;null===(_this_props_on_zoom_change=(_this_props=this.props).on_zoom_change)||void 0===_this_props_on_zoom_change||_this_props_on_zoom_change.call(_this_props,!1)},this.handle_unzoom_button_click=event=>{event.preventDefault(),event.stopPropagation(),this.handle_unzoom()},this.handle_dialog_cancel=event=>{event.preventDefault()},this.handle_dialog_click=event=>{event.target!==this.modal_content_ref.current&&event.target!==this.modal_img_ref.current||(event.stopPropagation(),this.handle_unzoom())},this.handle_dialog_close=event=>{event.stopPropagation(),this.handle_unzoom()},this.handle_key_down=event=>{"Escape"!==event.key&&27!==event.keyCode||(event.preventDefault(),event.stopPropagation(),this.handle_unzoom())},this.handle_wheel=event=>{event.ctrlKey||(event.stopPropagation(),queueMicrotask((()=>{this.handle_unzoom()})))},this.handle_touch_start=event=>{event.touches.length>1?this.is_scaling=!0:1===event.changedTouches.length&&event.changedTouches[0]&&(this.touch_y_start=event.changedTouches[0].screenY)},this.handle_touch_move=event=>{var _window_visualViewport,_window_visualViewport_scale;const browser_scale=null!==(_window_visualViewport_scale=null===(_window_visualViewport=window.visualViewport)||void 0===_window_visualViewport?void 0:_window_visualViewport.scale)&&void 0!==_window_visualViewport_scale?_window_visualViewport_scale:1;if(!this.is_scaling&&browser_scale<=1&&null!=this.touch_y_start&&event.changedTouches[0]){this.touch_y_end=event.changedTouches[0].screenY;const max=Math.max(this.touch_y_start,this.touch_y_end),min=Math.min(this.touch_y_start,this.touch_y_end);Math.abs(max-min)>this.props.swipe_to_unzoom_threshold&&(this.touch_y_start=void 0,this.touch_y_end=void 0,this.handle_unzoom())}},this.handle_touch_end=()=>{this.is_scaling=!1,this.touch_y_start=void 0,this.touch_y_end=void 0},this.handle_touch_cancel=()=>{this.is_scaling=!1,this.touch_y_start=void 0,this.touch_y_end=void 0},this.handle_resize=()=>{this.setState({should_refresh:!0})},this.has_image=()=>!(!this.img_element||!this.state.loaded_img_element||"none"===window.getComputedStyle(this.img_element).display),this.zoom=()=>{var _this_dialog_ref_current_showModal,_this_dialog_ref_current,_this_modal_img_ref_current_addEventListener,_this_modal_img_ref_current;this.body_scroll_disable(),null===(_this_dialog_ref_current=this.dialog_ref.current)||void 0===_this_dialog_ref_current||null===(_this_dialog_ref_current_showModal=_this_dialog_ref_current.showModal)||void 0===_this_dialog_ref_current_showModal||_this_dialog_ref_current_showModal.call(_this_dialog_ref_current),null===(_this_modal_img_ref_current=this.modal_img_ref.current)||void 0===_this_modal_img_ref_current||null===(_this_modal_img_ref_current_addEventListener=_this_modal_img_ref_current.addEventListener)||void 0===_this_modal_img_ref_current_addEventListener||_this_modal_img_ref_current_addEventListener.call(_this_modal_img_ref_current,"transitionend",this.handle_img_transition_end),this.set_navbar_visibility(!0),this.setState({modal_state:"loading"})},this.unzoom=()=>{this.set_navbar_visibility(!1),this.setState({modal_state:"unloading"})},this.handle_img_transition_end=()=>{clearTimeout(this.timeout_transition_end),"loading"===this.state.modal_state?this.setState({modal_state:"loaded"}):"unloading"===this.state.modal_state&&this.setState({should_refresh:!1,modal_state:"unloaded"})},this.ensure_img_transition_end=()=>{if(this.modal_img_ref.current){const td=window.getComputedStyle(this.modal_img_ref.current).transitionDuration,td_float=parseFloat(td);if(td_float){const td_ms=td_float*(td.endsWith("ms")?1:1e3)+50;this.timeout_transition_end=setTimeout(this.handle_img_transition_end,td_ms)}}},this.body_scroll_disable=()=>{this.prev_body_attrs={overflow:document.body.style.overflow,width:document.body.style.width};const client_width=document.body.clientWidth;document.body.style.overflow="hidden",document.body.style.width=`${client_width}px`},this.body_scroll_enable=()=>{document.body.style.width=this.prev_body_attrs.width,document.body.style.overflow=this.prev_body_attrs.overflow,this.prev_body_attrs=default_body_attrs},this.load_zoom_img=()=>{const{props:{slot_props:{zoom_img}={}}}=this,zoom_img_src=null==zoom_img?void 0:zoom_img.src;if(zoom_img_src){const img=new Image;var _zoom_img_sizes,_zoom_img_srcSet,_zoom_img_crossOrigin;img.sizes=null!==(_zoom_img_sizes=null==zoom_img?void 0:zoom_img.sizes)&&void 0!==_zoom_img_sizes?_zoom_img_sizes:"",img.srcset=null!==(_zoom_img_srcSet=null==zoom_img?void 0:zoom_img.srcSet)&&void 0!==_zoom_img_srcSet?_zoom_img_srcSet:"",img.crossOrigin=null!==(_zoom_img_crossOrigin=null==zoom_img?void 0:zoom_img.crossOrigin)&&void 0!==_zoom_img_crossOrigin?_zoom_img_crossOrigin:void 0,img.src=zoom_img_src;const set_loaded=()=>{this.setState({is_zoom_img_loaded:!0})};img.decode().then(set_loaded).catch((()=>{test_img_loaded(img)?set_loaded():img.onload=set_loaded}))}}}}ZoomBase.defaultProps={swipe_to_unzoom_threshold:10,wrap_element:"div",zoom_margin:0};const Zoom=props=>{const[is_zoomed,set_is_zoomed]=react.useState(!1);return(0,jsx_runtime.jsx)(ZoomBase,{...props,is_zoomed,on_zoom_change:set_is_zoomed})},zoom=Zoom;Zoom.__docgenInfo={description:"",methods:[],displayName:"Zoom",props:{children:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:"The children for the component."},dialog_class:{required:!1,tsType:{name:"string"},description:"The optional class name to apply to the dialog container."},slot_props:{required:!1,tsType:{name:"signature",type:"object",raw:"{\n  zoom_img?: React.ImgHTMLAttributes<HTMLImageElement>;\n}",signature:{properties:[{key:"zoom_img",value:{name:"ReactImgHTMLAttributes",raw:"React.ImgHTMLAttributes<HTMLImageElement>",elements:[{name:"HTMLImageElement"}],required:!1}}]}},description:"The props passed to the individual component elements."},swipe_to_unzoom_threshold:{required:!1,tsType:{name:"number"},description:"The threshold value for unzooming through swipe gestures.\n@default 10"},wrap_element:{required:!1,tsType:{name:"union",raw:'"div" | "span"',elements:[{name:"literal",value:'"div"'},{name:"literal",value:'"span"'}]},description:'The tag name for the wrapping element, either "div" or "span".\n@default \'div\''},zoom_margin:{required:!1,tsType:{name:"number"},description:"The margin to apply around the zoomed element."}}}},"./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[14].use[1]!./node_modules/resolve-url-loader/index.js!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[14].use[3]!./packages/ui/src/components/zoom/zoom.module.scss":(module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var _node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/css-loader/dist/runtime/sourceMaps.js"),_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0__),_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/css-loader/dist/runtime/api.js"),___CSS_LOADER_EXPORT___=__webpack_require__.n(_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__)()(_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default());___CSS_LOADER_EXPORT___.push([module.id,".ElGSy1O9Y_ZZhbw0bVD4{width:100%;height:100%;background-color:rgba(0,0,0,0);transition-property:background-color;transition-duration:0s;transition-delay:250ms}.ElGSy1O9Y_ZZhbw0bVD4.cnpX87jSeaSyBo56rovG{background-color:var(--bg-body);transition-delay:0s}.C1Y3BYKTh78l3s2Wyqf8{position:absolute;pointer-events:none}.l3Um__mx7Eq0QafQzCVA,.PWJq1SIq7fpotBrZ19WF{box-shadow:var(--shadow-sm);margin:0;touch-action:manipulation;appearance:none}.l3Um__mx7Eq0QafQzCVA{position:absolute;inset:10px 10px auto auto;cursor:zoom-in}.l3Um__mx7Eq0QafQzCVA:not(:focus):not(:active){position:absolute;clip:rect(0 0 0 0);clip-path:inset(50%);height:1px;overflow:hidden;pointer-events:none;white-space:nowrap;width:1px}.PWJq1SIq7fpotBrZ19WF{position:absolute;inset:20px 20px auto auto;cursor:zoom-out;z-index:1}.CBs8eiPjyBzpFYfC9F2K{width:100%;height:100%}.CBs8eiPjyBzpFYfC9F2K[data-state=ready] img,.CBs8eiPjyBzpFYfC9F2K[data-state=ready] [role=img],.CBs8eiPjyBzpFYfC9F2K[data-state=ready] [data-zoom]{cursor:zoom-in}.oto5Km7FVAm_F_TBHoyp::backdrop{display:none}.oto5Km7FVAm_F_TBHoyp[open]{position:fixed;width:100vw;width:100dvw;height:100vh;height:100dvh;max-width:none;max-height:none;margin:0;padding:0;border:0;background:rgba(0,0,0,0);overflow:hidden}.Ff46F1xxZs4zNSKH50gq{position:absolute;inset:0;transition:background-color 250ms}.Ff46F1xxZs4zNSKH50gq[data-state=hidden]{background-color:rgba(0,0,0,0)}.Ff46F1xxZs4zNSKH50gq[data-state=visible]{background-color:var(--bg-backdrop)}.QyR3KPTmps0OaNN8sUdk{position:relative;width:100%;height:100%}.mVHE_Z9dy80iMDPEjJQ4{position:absolute;cursor:zoom-out;image-rendering:high-quality;transform-origin:top left;transition:transform 250ms}@media(prefers-reduced-motion: reduce){.Ff46F1xxZs4zNSKH50gq,.mVHE_Z9dy80iMDPEjJQ4{transition-duration:.01ms !important}}","",{version:3,sources:["webpack://./packages/ui/src/components/zoom/zoom.module.scss"],names:[],mappings:"AAAA,sBACE,UAAA,CACA,WAAA,CACA,8BAAA,CACA,oCAAA,CACA,sBAAA,CACA,sBAAA,CAEA,2CACE,+BAAA,CACA,mBAAA,CAIJ,sBACE,iBAAA,CACA,mBAAA,CAGF,4CAEE,2BAAA,CACA,QAAA,CACA,yBAAA,CACA,eAAA,CAGF,sBACE,iBAAA,CACA,yBAAA,CACA,cAAA,CAEA,+CACE,iBAAA,CACA,kBAAA,CACA,oBAAA,CACA,UAAA,CACA,eAAA,CACA,mBAAA,CACA,kBAAA,CACA,SAAA,CAIJ,sBACE,iBAAA,CACA,yBAAA,CACA,eAAA,CACA,SAAA,CAGF,sBACE,UAAA,CACA,WAAA,CAGE,mJAGE,cAAA,CAMJ,gCACE,YAAA,CAIF,4BACE,cAAA,CACA,WAAA,CACA,YAAA,CACA,YAAA,CACA,aAAA,CACA,cAAA,CACA,eAAA,CACA,QAAA,CACA,SAAA,CACA,QAAA,CACA,wBAAA,CACA,eAAA,CAIJ,sBACE,iBAAA,CACA,OAAA,CACA,iCAAA,CAEA,yCACE,8BAAA,CAGF,0CACE,mCAAA,CAIJ,sBACE,iBAAA,CACA,UAAA,CACA,WAAA,CAGF,sBACE,iBAAA,CACA,eAAA,CACA,4BAAA,CACA,yBAAA,CACA,0BAAA,CAGF,uCACE,4CAEE,oCAAA,CAAA",sourcesContent:['.zoom {\n  width: 100%;\n  height: 100%;\n  background-color: transparent;\n  transition-property: background-color;\n  transition-duration: 0s;\n  transition-delay: 250ms;\n\n  &.active {\n    background-color: var(--bg-body);\n    transition-delay: 0s;\n  }\n}\n\n.ghost {\n  position: absolute;\n  pointer-events: none;\n}\n\n.zoom-btn,\n.unzoom-btn {\n  box-shadow: var(--shadow-sm);\n  margin: 0;\n  touch-action: manipulation;\n  appearance: none;\n}\n\n.zoom-btn {\n  position: absolute;\n  inset: 10px 10px auto auto;\n  cursor: zoom-in;\n\n  &:not(:focus):not(:active) {\n    position: absolute;\n    clip: rect(0 0 0 0);\n    clip-path: inset(50%);\n    height: 1px;\n    overflow: hidden;\n    pointer-events: none;\n    white-space: nowrap;\n    width: 1px;\n  }\n}\n\n.unzoom-btn {\n  position: absolute;\n  inset: 20px 20px auto auto;\n  cursor: zoom-out;\n  z-index: 1;\n}\n\n.content {\n  width: 100%;\n  height: 100%;\n\n  &[data-state="ready"] {\n    img,\n    [role="img"],\n    [data-zoom] {\n      cursor: zoom-in;\n    }\n  }\n}\n\n.modal {\n  &::backdrop {\n    display: none;\n  }\n\n  //noinspection CssOverwrittenProperties\n  &[open] {\n    position: fixed;\n    width: 100vw;\n    width: 100dvw;\n    height: 100vh;\n    height: 100dvh;\n    max-width: none;\n    max-height: none;\n    margin: 0;\n    padding: 0;\n    border: 0;\n    background: transparent;\n    overflow: hidden;\n  }\n}\n\n.overlay {\n  position: absolute;\n  inset: 0;\n  transition: background-color 250ms;\n\n  &[data-state="hidden"] {\n    background-color: transparent;\n  }\n\n  &[data-state="visible"] {\n    background-color: var(--bg-backdrop);\n  }\n}\n\n.modal-content {\n  position: relative;\n  width: 100%;\n  height: 100%;\n}\n\n.modal-img {\n  position: absolute;\n  cursor: zoom-out;\n  image-rendering: high-quality;\n  transform-origin: top left;\n  transition: transform 250ms;\n}\n\n@media (prefers-reduced-motion: reduce) {\n  .overlay,\n  .modal-img {\n    transition-duration: 0.01ms !important;\n  }\n}\n'],sourceRoot:""}]),___CSS_LOADER_EXPORT___.locals={zoom:"ElGSy1O9Y_ZZhbw0bVD4",active:"cnpX87jSeaSyBo56rovG",ghost:"C1Y3BYKTh78l3s2Wyqf8","zoom-btn":"l3Um__mx7Eq0QafQzCVA","unzoom-btn":"PWJq1SIq7fpotBrZ19WF",content:"CBs8eiPjyBzpFYfC9F2K",modal:"oto5Km7FVAm_F_TBHoyp",overlay:"Ff46F1xxZs4zNSKH50gq","modal-content":"QyR3KPTmps0OaNN8sUdk","modal-img":"mVHE_Z9dy80iMDPEjJQ4"};const __WEBPACK_DEFAULT_EXPORT__=___CSS_LOADER_EXPORT___}}]);